### Source functions

```{r}
source("../R/99_proj_func.R")
```

### Library:

```{r}
#| eval: false 
#| echo: true
#| message: false
library("tidyverse")
library("ggridges")
library("viridis")
library("broom")
library("ggrepel")
library("RColorBrewer")
```

### loading:

```{r}
#| eval: true
#| echo: true
#| message: false

ncbi_augment_pheno <- vroom::vroom("../data/04_ncbi_augment_pheno.tsv.gz",
                           delim = "\t")
#ncbi_joined <- vroom::vroom("../data/04_ncbi_joined.tsv.gz",
                              #delim = "\t")
ncbi_joined_aug <- vroom::vroom("../data/04_ncbi_joined_aug.tsv.gz",
                                 delim = "\t")
pheno_data |> 
  sample_n(5)

ncbi_joined_aug |> 
  sample_n(5)
```

### joining:

```{r}
#| eval: false 
#| echo: true

# Joining
joined_tables <- ncbi_augment_pheno |>
  full_join(wrangled_norm_exprs)
```

### plotting:

```{r}
#| eval: false 
#| echo: true

## Magnus

my_graph <- ggplot(data = )


```

### To be PCA
```{r}
# Fitting
pca_fit <- ncbi_joined_aug |>
  select(where(is.numeric)) |>
  prcomp(scale = TRUE)

# Adding PCA data to joined augmented data frame
pca_fit_augment <- pca_fit |> 
  augment(ncbi_joined_aug)
```


```{r}
# Plot PC1 vs PC2
pca_fit_augment  |> 
  ggplot(aes(x = .fittedPC1, 
             y = .fittedPC2,
             color = tissue)) + 
  geom_point() +
  theme_minimal() +
  labs(x = "PC1",
       y = "PC2",
       color = "Tissue",
       title = "Scatter plot of fitted PC1 and PC2") +
  scale_colour_brewer(palette = "Set1") +
  geom_hline(yintercept = 0, 
             linetype = "dashed") + 
  geom_vline(xintercept = 0, 
             linetype = "dashed")

#ggsave("../results/plots/scatter_pc1_pc2.png", 
#       plot = scatter_pc1_pc2)
#show(scatter_pc1_pc2)
```
```{r}
# Plot PC2 vs PC3
pca_fit_augment  |> 
  ggplot(aes(x = .fittedPC2, 
             y = .fittedPC3,
             color = tissue)) + 
  geom_point() +
  theme_minimal() +
  labs(x = "PC2",
       y = "PC3",
       color = "Tissue",
       title = "Scatter plot of fitted PC2 and PC3") +
  scale_colour_brewer(palette = "Set1") +
  geom_hline(yintercept = 0, 
             linetype = "dashed") + 
  geom_vline(xintercept = 0, 
             linetype = "dashed")

#ggsave("../results/plots/scatter_pc1_pc2.png", 
#       plot = scatter_pc1_pc2)
#show(scatter_pc1_pc2)
```

```{r}
ncbi_joined_aug |>
  ggplot(aes(x = smoking_status,
             y = newborn_weight,
             color = age_group)) +
  geom_point() +
  theme_minimal()
```

